\documentclass[report.tex]{subfiles}
\begin{document}

\chapter{Detailed Test Strategy and Test Cases} % (fold)
\label{cha:detailed_test_strategy_and_test_cases}
The Q'Grady testing saw a combination of JUnit and PRISM to determine the
quality of the produced system. JUnit was gradually added on a case by case
system, with the PRISM testing coming at the later stages of development to
specifically look at the file generation stage.

\section{JUnit Test Cases} % (fold)
\label{sec:junit_test_cases}
The JUnit Test Cases can be split into two groups, the \texttt{Box} tests and
the \texttt{SemanticAnalyser} tests. These two classes were the focus of JUnit
testing due to their calculations being the important part of the code.

\subsection{Testing Box Class} % (fold)
\label{sub:testing_box_class}
\subsubsection{Test Preparation} % (fold)
\label{ssub:test_preparation}
A PR box distribution is created, with a Box object created with the inputs
`x' \& `y' and the outputs `a' \& `b', each with ranges of 2.
% subsubsection test_preparation (end)

\subsubsection{convertListTest} % (fold)
\label{ssub:convertListTest}
Tests the conversion of \texttt{List<List<Double>} to \texttt{double[][]}. This
is needed to convert the parsed distribution into the distribution stored in the
class itself,  so the values must not change.
% subsubsection convertListTest (end)

\subsubsection{testInputs \& testOutputs} % (fold)
\label{ssub:test_input_output}
The \texttt{Box} object has various fields relating to the variable names and
ranges, as well as the amount of variables in the set-up that must be tested to
ensure there are none lost in the construction.
% subsubsection test_input_output (end)

\subsubsection{probTest} % (fold)
\label{ssub:probTest}
Test \texttt{getProb()} method. The method involves converting the given arrays
into their integer equivalent to obtain the correct indices. The test compares
the expected result with the actual result to determine whether the conversion
is correct and if the data is stored in that intended index.
% subsubsection probTest (end)

\subsubsection{probTestTwo} % (fold)
\label{ssub:probTestTwo}
Test the accuracy of reduced probability calculations. Two indices and their
values are given to the reduced probability method, and the given result is
compared to the expected result.
% subsubsection probTestTwo (end)

\subsubsection{probTestThree} % (fold)
\label{ssub:probTestThree}
Test the accuracy of normalised probability calculations. Two indices and their
values are given to the normalised probability method, and the given result is
compared to the expected result.
% subsubsection probTestThree (end)
% subsection testing_box_class (end)

\subsection{SemanticAnalysis} % (fold)
\label{sub:semanticanalysis}
\subsubsection{validateVariablesTest} % (fold)
\label{ssub:validatevariablestest}
This test method ensures that the restrictions on the variables are maintained.
Repeated variable names are to be flagged in addition to PRISM keywords.
% subsubsection validatevariablestest (end)

\subsubsection{validateUnequalVariablesTest} % (fold)
\label{ssub:validateunequalvariablestest}
This late tests ensures that more than two output variables are not allowed.
This is due to the failure of handling normalised probabilities when more than
two outputs are present.
% subsubsection validateunequalvariablestest (end)

\subsubsection{validateRowAmountsTest} % (fold)
\label{ssub:validaterowamountstest}
This method ensures that the related method is accurate in terms of highlighting
inequalities between the number of rows in the probability distribution and the
expected range to the power of the number of inputs.
% subsubsection validaterowamountstest (end)

\subsubsection{validateHigherValuesTest} % (fold)
\label{ssub:validatehighervaluestest}
Testing that values greater than 1.0 in the probability distribution are caught
by the method being tested.
% subsubsection validatehighervaluestest (end)

\subsubsection{validateLowerValuesTest} % (fold)
\label{ssub:validatelowervaluestest}
Testing that values less than 1.0 in the probability distribution are caught
by the method being tested.
% subsubsection validatelowervaluestest (end)

\subsubsection{validateGreaterRowLengthTest} % (fold)
\label{ssub:validategreaterrowlengthtest}
Tests that the check for ensuring that each row is of the expected length (that
being the output range to the power of the number of outputs). In this test
case, the given distribution is too large.
% subsubsection validategreaterrowlengthtest (end)

\subsubsection{validateSmallerRowLengthTest} % (fold)
\label{ssub:validatesmallerrowlengthtest}
Tests that the check for ensuring that each row is of the expected length (that
being the output range to the power of the number of outputs). In this test
case, the given distribution is too small.
% subsubsection validatesmallerrowlengthtest (end)

\subsubsection{validateGreaterRowSumsTest} % (fold)
\label{ssub:validategreaterrowsumstest}
Tests that the case where a row of probabilities in the distribution sums up to
a value greater than 1.0 is caught by the analyser.
% subsubsection validategreaterrowsumstest (end)

\subsubsection{validateSmallerRowSumTest} % (fold)
\label{ssub:validatesmallerrowsumtest}
Tests that the case where a row of probabilities in the distribution sums up to
a value less than 1.0 is caught by the analyser.
% subsubsection validatesmallerrowsumtest (end)
% subsection semanticanalysis (end)

\subsubsection{validateNonsignalling} % (fold)
\label{ssub:validatenonsignalling}
Test that ensures the analyser is able to detect non-signalling set-ups like the
PR box.
% subsubsection validatenonsignalling (end)

\subsubsection{validateSignalling} % (fold)
\label{ssub:validatesignalling}
Tests that a signalling distribution is caught by the non-signalling check.
% subsubsection validatesignalling (end)

\subsubsection{allIsWellTest} % (fold)
\label{ssub:alliswelltest}
A test that uses the PR box and goes through all semantic checks to ensure that
the box passes all tests.
% subsubsection alliswelltest (end)

\subsection{Summary} % (fold)
\label{sub:semantics_summary}
\begin{table}[H]
    \centering
    \begin{tabular}{l | p{6cm} | l}
    Test & Expected & Result \\    
    \hline
    convertListTest & List is successfully converted with values intact
    & as expected \\
    testInputs \& testOutputs & no exceptions are thrown & as expected \\
    probTest & the returned value matches expected value & as expected \\
    probTestTwo & returned results match expected values & as expected \\
    probTestThree & returned results match expected values
    & as expected \\
    \end{tabular}
    \caption{Results}
  \label{tab:box_summary}
\end{table}
\begin{table}[H]
    \centering
    \begin{tabular}{l | p{6cm} | l}
    Test & Expected & Result \\    
    \hline
    validateVariablesTest & Expected exceptions are caught successfully 
    & as expected \\
    validateUnequalVariablesTest & Expected exception is caught 
    & as expected \\
    validateRowAmountsTest & Expected exception is caught & as expected \\
    validateHigherValuesTest & Expected exception is caught & as expected \\
    validateLowerValuesTest & Expected exception is caught & as expected \\
    validateGreaterRowLengthTest & Expected exception is caught & as expected \\
    validateSmallerRowLengthTest & Expected exception is caught & as expected \\
    validateGreaterRowSumsTest & Expected exception is caught & as expected \\
    validateSmallerRowSumTest & Expected exception is caught & as expected \\
    validateNonsignalling & No exception is thrown to denote box is fine & as expected \\
    validateSignalling & Exception caught as expected signalling & as expected \\
    allIsWellTest & No exceptions are thrown & as expected \\
    \end{tabular}
    \caption{Results}
  \label{tab:semantics_summary}
\end{table}

% subsection summary (end)
% section junit_test_cases (end)
% subsubsection summary (end)

\section{PRISM Test Cases} % (fold)
\label{sec:prism_test_cases}
The following are Q'Grady files that are included in the submitted software.
There is a mixture of successful and unsuccessful set-ups.

These are files that are expected to produce valid PRISM models. For these
cases, a table will be provided showing the possible outcomes, the conditional
probability for that outcome, and the probability of the input and output (this
is for comparing with PRISM's steady state probabilities).

\subsection{pr.qgrady} % (fold)
\label{sub:pr_qgrady}
The PR box has two binary inputs (`x' and `y') and outputs (`a' and `b').
\begin{table}[H]
  \centering
  \begin{tabular}{c | c | c | c}
    Input & Output & \(P(a, b | x, y)\) & PRISM Prob \\
    \hline
    0, 0 & 0, 0 & 0.5 & 0.125 \\
    0, 0 & 1, 1 & 0.5 & 0.125 \\
    0, 1 & 0, 0 & 0.5 & 0.125 \\
    0, 1 & 1, 1 & 0.5 & 0.125 \\
    1, 0 & 0, 0 & 0.5 & 0.125 \\
    1, 0 & 1, 1 & 0.5 & 0.125 \\
    1, 1 & 0, 1 & 0.5 & 0.125 \\
    1, 1 & 1, 0 & 0.5 & 0.125 \\
  \end{tabular}
  \caption{Probability Distribution}
  \label{tab:pr_qgrady}
\end{table}
% subsection pr_qgrady (end)

\subsection{ternary.qgrady} % (fold)
\label{sub:ternary_qgrady}
This box has the output be ternary digits rather than binary like in the PR box.
\begin{table}[H]
  \centering
  \begin{tabular}{c | c | c | c}
    Input & Output & \(P(a, b | x, y)\) & PRISM Prob \\
    \hline
    0, 0 & 0, 0 & \(\frac{1}{3}\) & \(\frac{1}{12}\) \\
    0, 0 & 1, 1 & \(\frac{1}{3}\) & \(\frac{1}{12}\) \\
    0, 0 & 2, 2 & \(\frac{1}{3}\) & \(\frac{1}{12}\) \\
    0, 1 & 0, 0 & \(\frac{1}{3}\) & \(\frac{1}{12}\) \\
    0, 1 & 1, 1 & \(\frac{1}{3}\) & \(\frac{1}{12}\) \\
    0, 1 & 2, 2 & \(\frac{1}{3}\) & \(\frac{1}{12}\) \\
    1, 0 & 0, 0 & \(\frac{1}{3}\) & \(\frac{1}{12}\) \\
    1, 0 & 1, 2 & \(\frac{1}{3}\) & \(\frac{1}{12}\) \\
    1, 0 & 2, 2 & \(\frac{1}{3}\) & \(\frac{1}{12}\) \\
    1, 1 & 0, 1 & \(\frac{1}{3}\) & \(\frac{1}{12}\) \\
    1, 1 & 1, 2 & \(\frac{1}{3}\) & \(\frac{1}{12}\) \\
    1, 1 & 2, 0 & \(\frac{1}{3}\) & \(\frac{1}{12}\) \\
  \end{tabular}
  \caption{Probability Distribution}
  \label{tab:ternary_qgrady}
\end{table}
% subsection ternary_qgrady (end)

\subsection{tripartite.qgrady} % (fold)
\label{sub:threeinputs_qgrady}
This box has three binary inputs and outputs. Non-signalling is expected to
be upheld, and the compiler should produce an accurate model.
\begin{table}[H]
  \centering
  \begin{tabular}{c | c | c | c}
    Input & Output & \(P(a, b | x, y)\) & PRISM Prob \\
    \hline
    0, 0, 0 & 0, 0, 0 & 0.25 & 0.03125 \\
    0, 0, 0 & 0, 1, 1 & 0.25 & 0.03125 \\
    0, 0, 0 & 1, 0, 1 & 0.25 & 0.03125 \\
    0, 0, 0 & 1, 1, 0 & 0.25 & 0.03125 \\
    0, 0, 1 & 0, 0, 0 & 0.25 & 0.03125 \\
    0, 0, 1 & 0, 1, 1 & 0.25 & 0.03125 \\
    0, 0, 1 & 1, 0, 1 & 0.25 & 0.03125 \\
    0, 0, 1 & 1, 1, 0 & 0.25 & 0.03125 \\
    0, 1, 0 & 0, 0, 0 & 0.25 & 0.03125 \\
    0, 1, 0 & 0, 1, 1 & 0.25 & 0.03125 \\
    0, 1, 0 & 1, 0, 1 & 0.25 & 0.03125 \\
    0, 1, 0 & 1, 1, 0 & 0.25 & 0.03125 \\
    0, 1, 1 & 0, 0, 0 & 0.25 & 0.03125 \\
    0, 1, 1 & 0, 1, 1 & 0.25 & 0.03125 \\
    0, 1, 1 & 1, 0, 1 & 0.25 & 0.03125 \\
    0, 1, 1 & 1, 1, 0 & 0.25 & 0.03125 \\
    1, 0, 0 & 0, 0, 0 & 0.25 & 0.03125 \\
    1, 0, 0 & 0, 1, 1 & 0.25 & 0.03125 \\
    1, 0, 0 & 1, 0, 1 & 0.25 & 0.03125 \\
    1, 0, 0 & 1, 1, 0 & 0.25 & 0.03125 \\
    1, 0, 1 & 0, 0, 0 & 0.25 & 0.03125 \\
    1, 0, 1 & 0, 1, 1 & 0.25 & 0.03125 \\
    1, 0, 1 & 1, 0, 1 & 0.25 & 0.03125 \\
    1, 0, 1 & 1, 1, 0 & 0.25 & 0.03125 \\
    1, 1, 0 & 0, 0, 0 & 0.25 & 0.03125 \\
    1, 1, 0 & 0, 1, 1 & 0.25 & 0.03125 \\
    1, 1, 0 & 1, 0, 1 & 0.25 & 0.03125 \\
    1, 1, 0 & 1, 1, 0 & 0.25 & 0.03125 \\
    1, 1, 1 & 0, 0, 1 & 0.25 & 0.03125 \\
    1, 1, 1 & 0, 1, 0 & 0.25 & 0.03125 \\
    1, 1, 1 & 1, 0, 0 & 0.25 & 0.03125 \\
    1, 1, 1 & 1, 1, 1 & 0.25 & 0.03125 \\
  \end{tabular}
  \caption{Probability Distribution}
  \label{tab:threeinputs_qgrady}
\end{table}
% subsection threeinputs_qgrady (end)

\subsection{Summary} % (fold)
\label{sub:prism_summary}
\begin{table}[H]
  \centering
  \begin{tabular}{c | c | c | c}
    File & Compiles & Matches Prob & Time (ms)\\
    \hline
    pr.qgrady & Yes & Yes & 26.6 \\
    ternary.qgrady & Yes & Yes & 29.8 \\
    tripartite.qgrady & Yes & Yes 30\\
  \end{tabular}
  \caption{Results}
  \label{tab:prism_results}
\end{table}

As you can see, all three files compiled correctly, with the steady state 
probabilities of PRISM matching the probability distribution expected as well.
From looking at these results, it suggests that the impact of more inputs or
outputs, or the extension of the variables' ranges will not have a major
impact on performing. If time permitted, I would like to go more in-depth at
looking at this, but since the actual compile time was not a priority, it was
not seen as an essential thing to study.
% subsection summary (end)
% section prism_test_cases (end)
% chapter detailed_test_strategy_and_test_cases (end)
\newpage
\end{document}